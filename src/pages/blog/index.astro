---
import Base from '../../layouts/Base.astro';
import { Image } from 'astro:assets';
import Cover from '../../assets/blog-cover.jpg';

import { type CollectionEntry, getCollection, render } from 'astro:content';

const posts = await getCollection('blog');

type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await render(post);

---
<Base description="Home page for Akshat Mahajan's engineering blog Terminal Meditations" title="Akshat Mahajan | Blog about systems, cryptography, networks and computer science">
	<main role="main" aria-label="blog content">
		<article>
			<section role="main" aria-labelledby="about-heading" class="w-full">
			<hgroup>
				<h1>Terminal Meditations</h1>
				<p>Technical essays on software systems: protocols, networks, languages and architecture</p>
			</hgroup>
			<figure class="mt-[2rem]">
				<Image src={Cover} alt="Mountain Abode, Nicholas Roerich (1933)" title="Nicholas Roerich, 1933. Mountain Abode" class="px-4" />
				<figcaption><i>Mountain Abode</i>. Nicholas Roerich, 1933.</figcaption>
			</figure>
                {posts.map((post) => 
                    <div>
					<p class="dark:text-white/80 text-black/60 mb-[1rem] text-left">{post.data.pubDate.toLocaleDateString("en", {year: "numeric",month: "long", day: "numeric"})}</p>
                    <p set:html={post.data.description} class="px-4"/>
					<a href={`/blog/${post.id}`}><p class="mt-[1rem] text-right" set:html={post.data.title} /></a>
					</div>
                )}
			</section>
		</article>
	</main>
	<footer>
		<div class="flex md:flex-col justify-center text-left gap-[1rem] md:pl-8">
			<a href="/subscribe" class="text-xl">subscribe?</a>
			<a href="/rss.xml" class="text-xl">rss</a>
		</div>
	</footer>
</Base>
