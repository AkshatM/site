---
import PageLayout from '../layouts/BaseLayout.astro'
import Section from '../components/Section.astro'
import Label from '../components/Label.astro'
import SkillLayout from '../components/SkillLayout.astro'
import PostPreview from '@/components/blog/PostPreview.astro'

import { Image } from 'astro:assets'
import profile from '../assets/profile.webp'

import { getAllPosts, sortMDByDate } from '@/utils'

const languages = [
	{ title: 'Rust', bgColor: "bg-[#f74c00]", textColor: 'text-black'},
	{ title: 'Golang', bgColor: "bg-[#00ADD8]", textColor: 'text-white'},
	{ title: 'Python', textColor: 'text-[#FFE873]', bgColor: "bg-[#306998]"},
	{ title: 'Typescript', bgColor: "bg-[#3178C6]", textColor: "text-[#FFFFFF]"},
	{ title: 'Javascript', bgColor: "bg-[#F0DB4F]", textColor: "text-[#323330]"}
];
const infrastructure = [
	{ title: 'AWS', bgColor: "bg-[#FF9900]", textColor: "text-[#252F3E]"},
	{ title: 'Terraform', bgColor: "bg-[#4040B2]", textColor: "text-white"},
	{ title: 'Saltstack', bgColor: "bg-[#57bcad]", textColor: "text-[#151616]"},
	{ title: 'Kubernetes', bgColor: "bg-[#326CE5]", textColor: "text-white"},
];
const databases = [
	{ title: 'PostgreSQL', bgColor: "bg-[#0064a5]", textColor: "text-white"},
	{ title: 'SQLite', bgColor: "bg-[#90D4F4]", textColor: "text-[#003B57]"},
	{ title: 'Clickhouse', bgColor: "bg-[#212121]", textColor: "text-[#FBFF46]"},
	{ title: 'Redis', bgColor: "bg-[#A41E11]", textColor: "text-white"},
];
const observability = [
	{ title: 'Prometheus', bgColor: "bg-[#E6522C]", textColor: "text-white"},
	{ title: 'eBPF', bgColor: "bg-[#FFE100]", textColor: "text-black"},
	{ title: 'Datadog', bgColor: "bg-[#632CA6]", textColor: "text-white"},
];

const MAX_POSTS = 10
const allPosts = await getAllPosts()
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS)
---

<PageLayout meta={{ title: 'Home' }}>
	<div class='flex w-full flex-col gap-y-10'>
		<section class='flex flex-col items-center gap-y-7'>
			<Image
				src={profile}
				alt='profile photo'
				class='h-60 w-auto rounded-full p-2 bg-black'
				loading='eager'
			/>

			<div class='flex flex-col items-center gap-y-4'>
				<h1 class='md:text-5xl font-bold text-4xl'>Akshat Mahajan</h1>
				<div class='flex flex-wrap justify-center gap-x-7 gap-y-3'>
					<Label title='Senior Software Engineer'>
						<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' class='h-5 w-5' slot='icon'
							><path
								fill='currentColor'
								d='M4.615 20q-.69 0-1.152-.462Q3 19.075 3 18.385v-9.77q0-.69.463-1.152Q3.925 7 4.615 7H9V5.615q0-.69.463-1.152Q9.925 4 10.615 4h2.77q.69 0 1.153.463q.462.462.462 1.152V7h4.385q.69 0 1.152.463q.463.462.463 1.152v9.77q0 .69-.462 1.152q-.463.463-1.153.463zm0-1h14.77q.23 0 .423-.192q.192-.193.192-.423v-9.77q0-.23-.192-.423Q19.615 8 19.385 8H4.615q-.23 0-.423.192Q4 8.385 4 8.615v9.77q0 .23.192.423q.193.192.423.192M10 7h4V5.615q0-.23-.192-.423Q13.615 5 13.385 5h-2.77q-.23 0-.423.192q-.192.193-.192.423zM4 19V8z'
							></path>
						</svg>
					</Label>
					<Label title='Boston, MA, USA'>
						<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' class='h-5 w-5' slot='icon'
							><path
								fill='currentColor'
								d='M12.003 11.73q.668 0 1.14-.475q.472-.475.472-1.143t-.475-1.14q-.476-.472-1.143-.472t-1.14.476q-.472.475-.472 1.143t.475 1.14q.476.472 1.143.472M12 19.677q2.82-2.454 4.458-4.991q1.638-2.538 1.638-4.39q0-2.744-1.737-4.53T12 3.981q-2.621 0-4.359 1.785t-1.737 4.53q0 1.852 1.638 4.39q1.639 2.537 4.458 4.99m0 1.343q-3.525-3.117-5.31-5.814q-1.786-2.697-1.786-4.909q0-3.173 2.066-5.234Q9.037 3 12 3t5.03 2.062q2.066 2.061 2.066 5.234q0 2.212-1.785 4.909q-1.786 2.697-5.311 5.814m0-10.904'
							></path>
						</svg>
					</Label>
				</div>
			</div>
		</section>

		<Section title='About'>
			<h1 class='text-2xl font-semibold'>I build <i>fast</i>, <span class="text-muted-foreground">observable</span> distributed systems</h1>
			<p class='text-lg'>At Cloudflare, I shipped <a href="https://blog.cloudflare.com/verified-bots-with-cryptography/">web bot authentication</a> and its <a href="https://github.com/cloudflare/web-bot-auth">Rust SDK</a>, built control planes and L3/L4 proxies for <a href="https://www.cloudflare.com/application-services/products/argo-smart-routing/">Argo Smart Routing</a>, and helped power Apple Private Relay on the <a href="https://blog.cloudflare.com/privacy-edge-making-building-privacy-first-apps-easier/">Privacy Edge</a> team.</p>
			<p class='text-lg'>At PlanGrid and Autodesk, I built infrastructure that failed clearly, deployed safely, and recovered quickly. Earlier, I worked on large-scale data and networking systems, focused on throughput and correctness.</p>
			<p class='text-xl font-semibold'>Learn more from my <a href="/resume.pdf">resume</a>.</p>
			</Section>

		{
			allPostsByDate.length > 0 && (
				<Section title='Posts'>
					<ul class='flex flex-col gap-y-2'>
						{allPostsByDate.map((p) => (
							<li class='flex flex-col gap-x-2 sm:flex-row'>
								<PostPreview post={p} />
							</li>
						))}
					</ul>
				</Section>
			)
		}

		<Section title='Skills'>
			<SkillLayout title='Languages' skills={languages} />
			<SkillLayout title='Infrastructure' skills={infrastructure} />
			<SkillLayout title='Databases' skills={databases} />
			<SkillLayout title='Observability' skills={observability} />
		</Section>
	</div>
</PageLayout>
