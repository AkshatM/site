---
import PageLayout from '../layouts/BaseLayout.astro'
import Section from '../components/Section.astro'
import PostPreview from '@/components/blog/PostPreview.astro'

import { Image } from 'astro:assets'
import profile from '../assets/profile.webp'

import { getAllPosts, sortMDByDate } from '@/utils'

const languages = ['Rust', 'Go', 'Python', 'TypeScript']
const infrastructure = ['AWS', 'Terraform', 'Kubernetes', 'Saltstack', 'Cloudflare Workers']
const databases = ['PostgreSQL', 'SQLite', 'Clickhouse', 'Redis']
const observability = ['Prometheus', 'eBPF', 'Datadog']

const MAX_POSTS = 10
const allPosts = await getAllPosts()
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS)
---

<PageLayout meta={{ title: 'Home' }}>
	<div class='flex w-full flex-col'>
		<!-- Hero Section - Editorial asymmetric layout -->
		<section class='grid md:grid-cols-12 gap-8 md:gap-12 items-start mb-24 animate-fade-up'>
			<!-- Left column: Photo and meta -->
			<div class='md:col-span-4 flex flex-col gap-6 hidden md:flex'>
				<div class='relative'>
					<Image
						src={profile}
						alt='Akshat Mahajan'
						class='w-full max-w-[280px] aspect-square object-cover transition-all duration-500'
						decoding="async"
						loading="lazy"
					/>
					<div class='absolute -bottom-3 -right-3 w-24 h-24 border-2 border-accent -z-10'></div>
				</div>
				<div class='flex flex-col gap-2 text-sm tracking-wide text-muted-foreground'>
					<span class='uppercase'>Senior Software Engineer</span>
					<span>Boston, MA</span>
				</div>
			</div>

			<!-- Right column: Name and tagline -->
			<div class='md:col-span-8 flex flex-col justify-center'>
				<p class='text-sm uppercase tracking-[0.2em] text-muted-foreground mb-4 animate-fade-up-delay-1'>Portfolio & Technical Writing</p>
				<h1 class='font-display text-5xl md:text-7xl lg:text-8xl font-medium tracking-tight leading-[0.9] mb-8 animate-fade-up-delay-2'>
					Akshat<br/>Mahajan
				</h1>
				<p class='font-display text-2xl md:text-3xl italic text-muted-foreground leading-snug animate-fade-up-delay-3'>
					Transforming <span class='text-foreground not-italic'>distributed systems</span> into <span class='text-accent not-italic'>usable products</span><br class='hidden md:block' />
				</p>
			</div>
		</section>

		<!-- About Section - Magazine style -->
		<Section title='About' class='mb-20'>
			<div class='flex flex-col gap-6 animate-fade-up-delay-2'>
				<p class='text-lg md:text-xl !leading-snug'>
					I build <span class='font-semibold'>high-performance systems</span> and own their user-facing <span class="font-semibold">interfaces</span> â€” APIs, SDKs and operational workflows.
				</p>
				<p class='text-lg md:text-xl !leading-snug'>
					At <span class='font-semibold'>Cloudflare</span>, I shipped <a href="https://blog.cloudflare.com/verified-bots-with-cryptography/">web bot authentication</a> 
					and its <a href="https://github.com/cloudflare/web-bot-auth">open-source libraries</a>, sped up the adaptive routing platform behind <a href="https://www.cloudflare.com/application-services/products/argo-smart-routing/">Argo Smart Routing</a>, 
					and delivered the <a href="https://blog.cloudflare.com/privacy-edge-making-building-privacy-first-apps-easier/">privacy infrastructure</a> for Apple Private Relay.
				</p>
				<p class='text-lg md:text-xl !leading-snug'>
					At <span class='font-semibold'>PlanGrid</span> and <span class='font-semibold'>Autodesk</span>, I focused on making reliability-critical infrastructure safe, fast, and self-serve: automatic circuit breakers, canary platforms and disaster recovery.
				</p>
				<p class='text-lg md:text-xl !leading-snug'>
					Complex systems should be painless and delightful. 
				</p>
				<a href="/resume.pdf" class='inline-flex items-center gap-2 text-lg font-medium mt-2 group'>
					View full resume
					<svg class='w-4 h-4 transition-transform group-hover:translate-x-1' fill='none' stroke='currentColor' viewBox='0 0 24 24'>
						<path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17 8l4 4m0 0l-4 4m4-4H3'/>
					</svg>
				</a>
			</div>
		</Section>

		<!-- Posts Section - Editorial blog listing -->
		{
			allPostsByDate.length > 0 && (
				<Section title='Writing' class='mb-20'>
					<div class='flex flex-col divide-y divide-border animate-fade-up-delay-4'>
						{allPostsByDate.map((p) => (
							<PostPreview as='article' post={p} withDesc />
						))}
					</div>
				</Section>
			)
		}

		<!-- Skills Section - Clean typographic list -->
		<Section title='Expertise'>
			<div class='grid grid-cols-2 gap-8 animate-fade-up-delay-3'>
				<div class='flex flex-col gap-6'>
					<div>
						<h3 class='text-xs uppercase tracking-[0.15em] text-muted-foreground mb-3'>Languages</h3>
						<ul class="text-lg">
							{languages.map((x) => (
							<li>{x}</li>
						))}
						</ul>
					</div>
					<div>
						<h3 class='text-xs uppercase tracking-[0.15em] text-muted-foreground mb-3'>Infrastructure</h3>
						<ul class="text-lg">
							{infrastructure.map((x) => (
							<li>{x}</li>
						))}
						</ul>
					</div>
				</div>
				<div class='flex flex-col gap-6'>
					<div>
						<h3 class='text-xs uppercase tracking-[0.15em] text-muted-foreground mb-3'>Databases</h3>
						<ul class="text-lg">
							{databases.map((x) => (
							<li>{x}</li>
						))}
						</ul>
					</div>
					<div>
						<h3 class='text-xs uppercase tracking-[0.15em] text-muted-foreground mb-3'>Observability</h3>
						<ul class="text-lg">
							{observability.map((x) => (
							<li>{x}</li>
						))}
						</ul>
					</div>
				</div>
			</div>
		</Section>
	</div>
</PageLayout>
